require File.expand_path(File.dirname(__FILE__) + '/../../spec_helper')
require File.expand_path(File.dirname(__FILE__) + '/search_strategy_spec')


describe LigerEngine::SearchStrategies::GenbankSearchStrategy do
  fixtures :gi_numbers_pmids
  set_fixture_class :gi_numbers_pmids => 'PmidGenbank'
  
  it_should_behave_like 'A Search Strategy'
  
  before(:each) do
    @strategy = LigerEngine::SearchStrategies::GenbankSearchStrategy.new(:nucleotide)
    @query = sequence
  end
  
  describe '#initialize' do
    it "should switch algorithms depending on the value of the parameter" do
      LigerEngine::SearchStrategies::GenbankSearchStrategy.new(:amino_acid).blast_algorithm.should be_a TBlastN
      LigerEngine::SearchStrategies::GenbankSearchStrategy.new(:nucleotide).blast_algorithm.should be_a BlastN
      lambda{ LigerEngine::SearchStrategies::GenbankSearchStrategy.new(:jerome) }.should raise_error
    end
  end
end

def sequence
<<-END_GENE_SEQUENCE
>gi|41406056|ref|NM_201414.1| Homo sapiens amyloid beta (A4) precursor protein (peptidase nexin-II, Alzheimer disease) (APP), transcript variant 3, mRNA
GCTGACTCGCCTGGCTCTGAGCCCCGCCGCCGCGCTCGGGCTCCGTCAGTTTCCTCGGCAGCGGTAGGCG
AGAGCACGCGGAGGAGCGTGCGCGGGGGCCCCGGGAGACGGCGGCGGTGGCGGCGCGGGCAGAGCAAGGA
CGCGGCGGATCCCACTCGCACAGCAGCGCACTCGGTGCCCCGCGCAGGGTCGCGATGCTGCCCGGTTTGG
CACTGCTCCTGCTGGCCGCCTGGACGGCTCGGGCGCTGGAGGTACCCACTGATGGTAATGCTGGCCTGCT
GGCTGAACCCCAGATTGCCATGTTCTGTGGCAGACTGAACATGCACATGAATGTCCAGAATGGGAAGTGG
GATTCAGATCCATCAGGGACCAAAACCTGCATTGATACCAAGGAAGGCATCCTGCAGTATTGCCAAGAAG
TCTACCCTGAACTGCAGATCACCAATGTGGTAGAAGCCAACCAACCAGTGACCATCCAGAACTGGTGCAA
GCGGGGCCGCAAGCAGTGCAAGACCCATCCCCACTTTGTGATTCCCTACCGCTGCTTAGTTGGTGAGTTT
GTAAGTGATGCCCTTCTCGTTCCTGACAAGTGCAAATTCTTACACCAGGAGAGGATGGATGTTTGCGAAA
CTCATCTTCACTGGCACACCGTCGCCAAAGAGACATGCAGTGAGAAGAGTACCAACTTGCATGACTACGG
CATGTTGCTGCCCTGCGGAATTGACAAGTTCCGAGGGGTAGAGTTTGTGTGTTGCCCACTGGCTGAAGAA
AGTGACAATGTGGATTCTGCTGATGCGGAGGAGGATGACTCGGATGTCTGGTGGGGCGGAGCAGACACAG
ACTATGCAGATGGGAGTGAAGACAAAGTAGTAGAAGTAGCAGAGGAGGAAGAAGTGGCTGAGGTGGAAGA
AGAAGAAGCCGATGATGACGAGGACGATGAGGATGGTGATGAGGTAGAGGAAGAGGCTGAGGAACCCTAC
GAAGAAGCCACAGAGAGAACCACCAGCATTGCCACCACCACCACCACCACCACAGAGTCTGTGGAAGAGG
TGGTTCGAGTTCCTACAACAGCAGCCAGTACCCCTGATGCCGTTGACAAGTATCTCGAGACACCTGGGGA
TGAGAATGAACATGCCCATTTCCAGAAAGCCAAAGAGAGGCTTGAGGCCAAGCACCGAGAGAGAATGTCC
CAGGTCATGAGAGAATGGGAAGAGGCAGAACGTCAAGCAAAGAACTTGCCTAAAGCTGATAAGAAGGCAG
TTATCCAGCATTTCCAGGAGAAAGTGGAATCTTTGGAACAGGAAGCAGCCAACGAGAGACAGCAGCTGGT
GGAGACACACATGGCCAGAGTGGAAGCCATGCTCAATGACCGCCGCCGCCTGGCCCTGGAGAACTACATC
ACCGCTCTGCAGGCTGTTCCTCCTCGGCCTCGTCACGTGTTCAATATGCTAAAGAAGTATGTCCGCGCAG
AACAGAAGGACAGACAGCACACCCTAAAGCATTTCGAGCATGTGCGCATGGTGGATCCCAAGAAAGCCGC
TCAGATCCGGTCCCAGGTTATGACACACCTCCGTGTGATTTATGAGCGCATGAATCAGTCTCTCTCCCTG
CTCTACAACGTGCCTGCAGTGGCCGAGGAGATTCAGGATGAAGTTGATGAGCTGCTTCAGAAAGAGCAAA
ACTATTCAGATGACGTCTTGGCCAACATGATTAGTGAACCAAGGATCAGTTACGGAAACGATGCTCTCAT
GCCATCTTTGACCGAAACGAAAACCACCGTGGAGCTCCTTCCCGTGAATGGAGAGTTCAGCCTGGACGAT
CTCCAGCCGTGGCATTCTTTTGGGGCTGACTCTGTGCCAGCCAACACAGAAAACGAAGTTGAGCCTGTTG
ATGCCCGCCCTGCTGCCGACCGAGGACTGACCACTCGACCAGGTTCTGGGTTGACAAATATCAAGACGGA
GGAGATCTCTGAAGTGAAGATGGATGCAGAATTCCGACATGACTCAGGATATGAAGTTCATCATCAAAAA
TTGGTGTTCTTTGCAGAAGATGTGGGTTCAAACAAAGGTGCAATCATTGGACTCATGGTGGGCGGTGTTG
TCATAGCGACAGTGATCGTCATCACCTTGGTGATGCTGAAGAAGAAACAGTACACATCCATTCATCATGG
TGTGGTGGAGGTTGACGCCGCTGTCACCCCAGAGGAGCGCCACCTGTCCAAGATGCAGCAGAACGGCTAC
GAAAATCCAACCTACAAGTTCTTTGAGCAGATGCAGAACTAGACCCCCGCCACAGCAGCCTCTGAAGTTG
GACAGCAAAACCATTGCTTCACTACCCATCGGTGTCCATTTATAGAATAATGTGGGAAGAAACAAACCCG
TTTTATGATTTACTCATTATCGCCTTTTGACAGCTGTGCTGTAACACAAGTAGATGCCTGAACTTGAATT
AATCCACACATCAGTAATGTATTCTATCTCTCTTTACATTTTGGTCTCTATACTACATTATTAATGGGTT
TTGTGTACTGTAAAGAATTTAGCTGTATCAAACTAGTGCATGAATAGATTCTCTCCTGATTATTTATCAC
ATAGCCCCTTAGCCAGTTGTATATTATTCTTGTGGTTTGTGACCCAATTAAGTCCTACTTTACATATGCT
TTAAGAATCGATGGGGGATGCTTCATGTGAACGTGGGAGTTCAGCTGCTTCTCTTGCCTAAGTATTCCTT
TCCTGATCACTATGCATTTTAAAGTTAAACATTTTTAAGTATTTCAGATGCTTTAGAGAGATTTTTTTTC
CATGACTGCATTTTACTGTACAGATTGCTGCTTCTGCTATATTTGTGATATAGGAATTAAGAGGATACAC
ACGTTTGTTTCTTCGTGCCTGTTTTATGTGCACACATTAGGCATTGAGACTTCAAGCTTTTCTTTTTTTG
TCCACGTATCTTTGGGTCTTTGATAAAGAAAAGAATCCCTGTTCATTGTAAGCACTTTTACGGGGCGGGT
GGGGAGGGGTGCTCTGCTGGTCTTCAATTACCAAGAATTCTCCAAAACAATTTTCTGCAGGATGATTGTA
CAGAATCATTGCTTATGACATGATCGCTTTCTACACTGTATTACATAAATAAATTAAATAAAATAACCCC
GGGCAAGACTTTTCTTTGAAGGATGACTACAGACATTAAATAATCGAAGTAATTTTGGGTGGGGAGAAGA
GGCAGATTCAATTTTCTTTAACCAGTCTGAAGTTTCATTTATGATACAAAAGAAGATGAAAATGGAAGTG
GCAATATAAGGGGATGAGGAAGGCATGCCTGGACAAACCCTTCTTTTAAGATGTGTCTTCAATTTGTATA
AAATGGTGTTTTCATGTAAATAAATACATTCTTGGAGGAGCAAAAAAAAAAAAAAA
END_GENE_SEQUENCE
end